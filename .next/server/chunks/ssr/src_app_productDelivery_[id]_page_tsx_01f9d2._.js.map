{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/KRB2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/productDelivery/%5Bid%5D/page.tsx"],"sourcesContent":["\r\n\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { api } from \"~/trpc/react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\n\r\nexport default function OrderPage() {\r\n  const params = useParams();\r\n  const router = useRouter();\r\n  const id = params.id as string;\r\n  const [declineReason, setDeclineReason] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const { data: order, isLoading, isError } = api.order.getOrder.useQuery(\r\n    { orderId: id },\r\n    { enabled: !!id }\r\n  );\r\n\r\n  const issueOrderMutation = api.order.issueOrder.useMutation();\r\n  const declineOrderMutation = api.order.declineOrder.useMutation();\r\n\r\n  const handleIssueOrder = () => {\r\n    setError(\"\");\r\n    issueOrderMutation.mutate(\r\n      { orderId: id },\r\n      {\r\n        onSuccess: () => {\r\n          router.push(\"/productDelivery\");\r\n        },\r\n        onError: (err) => {\r\n          setError(err.message);\r\n        },\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleDeclineOrder = () => {\r\n    if (declineReason.length < 5) {\r\n      setError(\"Укажите причину отказа (минимум 5 символов)\");\r\n      return;\r\n    }\r\n    \r\n    setError(\"\");\r\n    declineOrderMutation.mutate(\r\n      { orderId: id, reason: declineReason },\r\n      {\r\n        onSuccess: () => {\r\n          router.push(\"/productDelivery\");\r\n        },\r\n        onError: (err) => {\r\n          setError(err.message);\r\n        },\r\n      }\r\n    );\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"p-6 flex justify-center\">\r\n        <p>Загрузка данных о заказе...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (isError || !order) {\r\n    return (\r\n      <div className=\"p-6 text-red-500\">\r\n        Ошибка при загрузке данных заказа\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"p-6 max-w-4xl mx-auto\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">\r\n        Заказ №{order.id} - {order.user.surname} {order.user.name}\r\n      </h1>\r\n\r\n      {error && (\r\n        <div className=\"mb-4 p-3 bg-red-100 text-red-700 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"bg-white rounded-lg shadow p-6\">\r\n        <h2 className=\"text-lg font-semibold mb-4\">Товары в заказе</h2>\r\n        \r\n        <div className=\"divide-y\">\r\n          {order.items.map((item) => (\r\n            <div key={item.product.id} className=\"py-3 flex justify-between\">\r\n              <div>\r\n                <p className=\"font-medium\">{item.product.name}</p>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {item.quantity} × {item.product.price} ₽ = {item.quantity * item.product.price} ₽\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"mt-6 space-y-3\">\r\n          <button\r\n            className=\"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 disabled:bg-gray-400\"\r\n            onClick={handleIssueOrder}\r\n            \r\n          >Выдан заказ\r\n          </button>\r\n\r\n          <div className=\"mt-4\">\r\n            <textarea\r\n              className=\"w-full p-3 border rounded\"\r\n              placeholder=\"Причина отказа (минимум 5 символов)\"\r\n              value={declineReason}\r\n              onChange={(e) => setDeclineReason(e.target.value)}\r\n              rows={3}\r\n            />\r\n            <button\r\n              className=\"w-full mt-2 bg-red-600 text-white py-2 rounded hover:bg-red-700 disabled:bg-gray-400\"\r\n              onClick={handleDeclineOrder}\r\n            > Отказ от заказа\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAGA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,iPAAA,CAAA,YAAS,AAAD;IACvB,MAAM,SAAS,CAAA,GAAA,iPAAA,CAAA,YAAS,AAAD;IACvB,MAAM,KAAK,OAAO,EAAE;IACpB,MAAM,CAAC,eAAe,iBAAiB,GAAG,CAAA,GAAA,oTAAA,CAAA,WAAQ,AAAD,EAAE;IACnD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,oTAAA,CAAA,WAAQ,AAAD,EAAE;IAEnC,MAAM,EAAE,MAAM,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,qHAAA,CAAA,MAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CACrE;QAAE,SAAS;IAAG,GACd;QAAE,SAAS,CAAC,CAAC;IAAG;IAGlB,MAAM,qBAAqB,qHAAA,CAAA,MAAG,CAAC,KAAK,CAAC,UAAU,CAAC,WAAW;IAC3D,MAAM,uBAAuB,qHAAA,CAAA,MAAG,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW;IAE/D,MAAM,mBAAmB;QACvB,SAAS;QACT,mBAAmB,MAAM,CACvB;YAAE,SAAS;QAAG,GACd;YACE,WAAW;gBACT,OAAO,IAAI,CAAC;YACd;YACA,SAAS,CAAC;gBACR,SAAS,IAAI,OAAO;YACtB;QACF;IAEJ;IAEA,MAAM,qBAAqB;QACzB,IAAI,cAAc,MAAM,GAAG,GAAG;YAC5B,SAAS;YACT;QACF;QAEA,SAAS;QACT,qBAAqB,MAAM,CACzB;YAAE,SAAS;YAAI,QAAQ;QAAc,GACrC;YACE,WAAW;gBACT,OAAO,IAAI,CAAC;YACd;YACA,SAAS,CAAC;gBACR,SAAS,IAAI,OAAO;YACtB;QACF;IAEJ;IAEA,IAAI,WAAW;QACb,qBACE,6VAAC;YAAI,WAAU;sBACb,cAAA,6VAAC;0BAAE;;;;;;;;;;;IAGT;IAEA,IAAI,WAAW,CAAC,OAAO;QACrB,qBACE,6VAAC;YAAI,WAAU;sBAAmB;;;;;;IAItC;IAEA,qBACE,6VAAC;QAAK,WAAU;;0BACd,6VAAC;gBAAG,WAAU;;oBAA0B;oBAC9B,MAAM,EAAE;oBAAC;oBAAI,MAAM,IAAI,CAAC,OAAO;oBAAC;oBAAE,MAAM,IAAI,CAAC,IAAI;;;;;;;YAG1D,uBACC,6VAAC;gBAAI,WAAU;0BACZ;;;;;;0BAIL,6VAAC;gBAAI,WAAU;;kCACb,6VAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAE3C,6VAAC;wBAAI,WAAU;kCACZ,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,qBAChB,6VAAC;gCAA0B,WAAU;0CACnC,cAAA,6VAAC;;sDACC,6VAAC;4CAAE,WAAU;sDAAe,KAAK,OAAO,CAAC,IAAI;;;;;;sDAC7C,6VAAC;4CAAE,WAAU;;gDACV,KAAK,QAAQ;gDAAC;gDAAI,KAAK,OAAO,CAAC,KAAK;gDAAC;gDAAM,KAAK,QAAQ,GAAG,KAAK,OAAO,CAAC,KAAK;gDAAC;;;;;;;;;;;;;+BAJ3E,KAAK,OAAO,CAAC,EAAE;;;;;;;;;;kCAW7B,6VAAC;wBAAI,WAAU;;0CACb,6VAAC;gCACC,WAAU;gCACV,SAAS;0CAEV;;;;;;0CAGD,6VAAC;gCAAI,WAAU;;kDACb,6VAAC;wCACC,WAAU;wCACV,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;wCAChD,MAAM;;;;;;kDAER,6VAAC;wCACC,WAAU;wCACV,SAAS;kDACV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOb"}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}