{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/productUI.tsx"],"sourcesContent":["import { notFound } from \"next/navigation\";\r\n\r\nexport default async function ProductDetails({ product }: { product: any }) {\r\n  if (!product) return notFound();\r\n\r\n  return (\r\n    <div className=\"container mx-auto py-8 px-6 max-w-3xl\">\r\n      <h1 className=\"text-4xl font-extrabold text-gray-900 mb-6\">{product.name}</h1>\r\n\r\n      <div className=\"flex justify-center mb-6\">\r\n        <img\r\n          src={product.imageUrl || undefined}\r\n          alt={product.name}\r\n          className=\"w-full max-w-lg rounded-lg shadow-xl\"\r\n        />\r\n      </div>\r\n\r\n      <p className=\"text-lg text-gray-800 mb-4\">{product.description}</p>\r\n\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <p className=\"text-2xl font-semibold text-blue-600\">\r\n          {Number(product.price.toString()).toLocaleString(\"ru-RU\", {\r\n            style: \"currency\",\r\n            currency: \"RUB\",\r\n          })}\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"bg-gray-100 p-4 rounded-lg shadow-md mb-6\">\r\n        <p className=\"text-sm text-gray-500 mb-1\">\r\n          <strong>Категория:</strong> <span className=\"font-medium\">{product.category.name}</span>\r\n        </p>\r\n        <p className=\"text-sm text-gray-500 mb-1\">\r\n          <strong>На складе:</strong> <span className=\"font-medium\">{product.stock}</span>\r\n        </p>\r\n        <p className=\"text-sm text-gray-500 mb-1\">\r\n          <strong>Создано:</strong>{\" \"}\r\n          {new Date(product.createdAt).toLocaleDateString(\"ru-RU\", {\r\n            day: \"numeric\",\r\n            month: \"long\",\r\n            year: \"numeric\",\r\n          })}\r\n        </p>\r\n        <p className=\"text-sm text-gray-500 mb-4\">\r\n          <strong>Обновлено:</strong>{\" \"}\r\n          {new Date(product.updatedAt).toLocaleDateString(\"ru-RU\", {\r\n            day: \"numeric\",\r\n            month: \"long\",\r\n            year: \"numeric\",\r\n          })}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;;;AAEe,eAAe,eAAe,EAAE,OAAO,EAAoB;IACxE,IAAI,CAAC,SAAS,OAAO,CAAA,GAAA,oTAAA,CAAA,WAAQ,AAAD;IAE5B,qBACE,6WAAC;QAAI,WAAU;;0BACb,6WAAC;gBAAG,WAAU;0BAA8C,QAAQ,IAAI;;;;;;0BAExE,6WAAC;gBAAI,WAAU;0BACb,cAAA,6WAAC;oBACC,KAAK,QAAQ,QAAQ,IAAI;oBACzB,KAAK,QAAQ,IAAI;oBACjB,WAAU;;;;;;;;;;;0BAId,6WAAC;gBAAE,WAAU;0BAA8B,QAAQ,WAAW;;;;;;0BAE9D,6WAAC;gBAAI,WAAU;0BACb,cAAA,6WAAC;oBAAE,WAAU;8BACV,OAAO,QAAQ,KAAK,CAAC,QAAQ,IAAI,cAAc,CAAC,SAAS;wBACxD,OAAO;wBACP,UAAU;oBACZ;;;;;;;;;;;0BAIJ,6WAAC;gBAAI,WAAU;;kCACb,6WAAC;wBAAE,WAAU;;0CACX,6WAAC;0CAAO;;;;;;4BAAmB;0CAAC,6WAAC;gCAAK,WAAU;0CAAe,QAAQ,QAAQ,CAAC,IAAI;;;;;;;;;;;;kCAElF,6WAAC;wBAAE,WAAU;;0CACX,6WAAC;0CAAO;;;;;;4BAAmB;0CAAC,6WAAC;gCAAK,WAAU;0CAAe,QAAQ,KAAK;;;;;;;;;;;;kCAE1E,6WAAC;wBAAE,WAAU;;0CACX,6WAAC;0CAAO;;;;;;4BAAkB;4BACzB,IAAI,KAAK,QAAQ,SAAS,EAAE,kBAAkB,CAAC,SAAS;gCACvD,KAAK;gCACL,OAAO;gCACP,MAAM;4BACR;;;;;;;kCAEF,6WAAC;wBAAE,WAAU;;0CACX,6WAAC;0CAAO;;;;;;4BAAoB;4BAC3B,IAAI,KAAK,QAAQ,SAAS,EAAE,kBAAkB,CAAC,SAAS;gCACvD,KAAK;gCACL,OAAO;gCACP,MAAM;4BACR;;;;;;;;;;;;;;;;;;;AAKV"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/addToCartButton.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/producList/addToCartButton.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/producList/addToCartButton.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAsT,GACnV,oFACA"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 200, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/addToCartButton.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/producList/addToCartButton.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/producList/addToCartButton.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAkS,GAC/T,gEACA"}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 214, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/rerwies/reviews.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/rerwies/reviews.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/rerwies/reviews.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA2S,GACxU,yEACA"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 238, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/rerwies/reviews.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/rerwies/reviews.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/rerwies/reviews.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAuR,GACpT,qDACA"}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/editProductWrapper.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/producList/editProductWrapper.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/producList/editProductWrapper.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAyT,GACtV,uFACA"}},
    {"offset": {"line": 270, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 276, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/editProductWrapper.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/producList/editProductWrapper.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/producList/editProductWrapper.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAqS,GAClU,mEACA"}},
    {"offset": {"line": 284, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 300, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/deleteProduct.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/producList/deleteProduct.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/producList/deleteProduct.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAoT,GACjV,kFACA"}},
    {"offset": {"line": 308, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 314, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/producList/deleteProduct.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/producList/deleteProduct.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/producList/deleteProduct.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAgS,GAC7T,8DACA"}},
    {"offset": {"line": 322, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 328, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 332, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 338, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/rerwies/addreview.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/rerwies/addreview.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/rerwies/addreview.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA6S,GAC1U,2EACA"}},
    {"offset": {"line": 346, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 352, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/_components/rerwies/addreview.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/_components/rerwies/addreview.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/_components/rerwies/addreview.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,oXAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAyR,GACtT,uDACA"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 366, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 376, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/product/%5Bid%5D/page.tsx"],"sourcesContent":["import { db } from \"~/server/db\";\r\nimport { notFound } from \"next/navigation\";\r\nimport ProductDetails from \"~/app/_components/producList/productUI\";\r\nimport AddToCartButton from \"~/app/_components/producList/addToCartButton\";\r\nimport Reviews from \"~/app/_components/rerwies/reviews\";\r\nimport EditProductWrapper from \"~/app/_components/producList/editProductWrapper\";\r\nimport DeleteButton from \"~/app/_components/producList/deleteProduct\";\r\nimport { auth } from \"~/server/auth\";\r\nimport AddReview from \"~/app/_components/rerwies/addreview\";\r\n\r\nexport default async function ProductPage(\r\n  props: { params: Promise<{ id: string }> }\r\n) {\r\n  const session = await auth();\r\n  const user = await db.user.findUnique({ where: { id: session?.user?.id } });\r\n  const params = await props.params;\r\n\r\n  const product = await db.product.findUnique({\r\n    where: { id: params.id },\r\n    include: {\r\n      category: true,\r\n      images: true, // <-- добавлено\r\n    },\r\n  });\r\n\r\n  const categories = await db.category.findMany();\r\n\r\n  if (!product) return notFound();\r\n  const role = (await auth())?.user.role;\r\n  const isAuthorized = role === \"ADMIN\" || role === \"WORKER\";\r\n  return (\r\n    <div className=\"p-4\">\r\n      {isAuthorized && (\r\n      <EditProductWrapper product={product} categories={categories} />\r\n\r\n        )}\r\n      \r\n      <ProductDetails product={product} />\r\n      {!isAuthorized && (\r\n      <AddToCartButton productId={product.id} stock = {product.stock} />\r\n\r\n        )}\r\n        {isAuthorized && (\r\n        <DeleteButton productId={product.id} />\r\n\r\n        )}\r\n      {/* <AddToCartButton productId={product.id} /> */}\r\n      <AddReview productId={product.id} />\r\n      <Reviews productId={product.id} />\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;;;;AASe,eAAe,YAC5B,KAA0C;IAE1C,MAAM,UAAU,MAAM,CAAA,GAAA,8HAAA,CAAA,OAAI,AAAD;IACzB,MAAM,OAAO,MAAM,mHAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE,IAAI,SAAS,MAAM;QAAG;IAAE;IACzE,MAAM,SAAS,MAAM,MAAM,MAAM;IAEjC,MAAM,UAAU,MAAM,mHAAA,CAAA,KAAE,CAAC,OAAO,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI,OAAO,EAAE;QAAC;QACvB,SAAS;YACP,UAAU;YACV,QAAQ;QACV;IACF;IAEA,MAAM,aAAa,MAAM,mHAAA,CAAA,KAAE,CAAC,QAAQ,CAAC,QAAQ;IAE7C,IAAI,CAAC,SAAS,OAAO,CAAA,GAAA,oTAAA,CAAA,WAAQ,AAAD;IAC5B,MAAM,OAAO,CAAC,MAAM,CAAA,GAAA,8HAAA,CAAA,OAAI,AAAD,GAAG,GAAG,KAAK;IAClC,MAAM,eAAe,SAAS,WAAW,SAAS;IAClD,qBACE,6WAAC;QAAI,WAAU;;YACZ,8BACD,6WAAC,8JAAA,CAAA,UAAkB;gBAAC,SAAS;gBAAS,YAAY;;;;;;0BAIlD,6WAAC,qJAAA,CAAA,UAAc;gBAAC,SAAS;;;;;;YACxB,CAAC,8BACF,6WAAC,2JAAA,CAAA,UAAe;gBAAC,WAAW,QAAQ,EAAE;gBAAE,OAAS,QAAQ,KAAK;;;;;;YAG3D,8BACD,6WAAC,yJAAA,CAAA,UAAY;gBAAC,WAAW,QAAQ,EAAE;;;;;;0BAIrC,6WAAC,kJAAA,CAAA,UAAS;gBAAC,WAAW,QAAQ,EAAE;;;;;;0BAChC,6WAAC,gJAAA,CAAA,UAAO;gBAAC,WAAW,QAAQ,EAAE;;;;;;;;;;;;AAGpC"}},
    {"offset": {"line": 475, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 487, "column": 0}, "map": {"version":3,"sources":["file://D%3A/PP_2/12345%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F%20%E2%80%94%20%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F/rater/src/app/api/action/product.ts"],"sourcesContent":["// \"use server\";\r\n\r\n// import { revalidatePath } from \"next/cache\";\r\n// import { redirect } from \"next/navigation\";\r\n// import { z } from \"zod\";\r\n// import { auth } from \"~/server/auth\";\r\n// import { db } from \"~/server/db\";\r\n// import { createClient } from '@supabase/supabase-js';\r\n// export async function createProduct(formData: FormData) {\r\n//   const fd = z\r\n//     .object({\r\n//       name: z.string(),\r\n//       description: z.string(),\r\n//       price: z.coerce.number().positive(),\r\n//       imageUrl: z.string().url().optional().or(z.literal(\"\")),\r\n//       categoryId: z.string(),\r\n//     })\r\n//     .parse({\r\n//       name: formData.get(\"name\"),\r\n//       description: formData.get(\"description\"),\r\n//       price: formData.get(\"price\"),\r\n//       imageUrl: formData.get(\"imageUrl\"),\r\n//       categoryId: formData.get(\"categoryId\"),\r\n//     });\r\n\r\n//   await db.product.create({\r\n//     data: {\r\n//       name: fd.name,\r\n//       description: fd.description,\r\n//       price: fd.price,\r\n//       imageUrl: fd.imageUrl || \"\",\r\n//       categoryId: fd.categoryId,\r\n//     },\r\n//   });\r\n\r\n//   revalidatePath(\"/product\");\r\n//   redirect(\"/product\"); \r\n// }\r\n// const supabase = createClient(\r\n//   process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n//   process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n// );\r\n\r\n// // export async function createProduct(formData: FormData) {\r\n// //   const name = formData.get(\"name\") as string;\r\n// //   const description = formData.get(\"description\") as string;\r\n// //   const price = parseFloat(formData.get(\"price\") as string);\r\n// //   const categoryId = formData.get(\"categoryId\") as string;\r\n// //   const file = formData.get(\"image\") as File;\r\n\r\n// //   if (!file || file.size === 0) throw new Error(\"Файл изображения не выбран\");\r\n\r\n// //   const filePath = `products/${Date.now()}-${file.name}`;\r\n\r\n// //   // Загрузка в Supabase Storage\r\n// //   const { error: uploadError } = await supabase.storage\r\n// //     .from('product-images')\r\n// //     .upload(filePath, file, { upsert: true });\r\n\r\n// //   if (uploadError) throw uploadError;\r\n\r\n// //   const { data: imageData } = supabase\r\n// //     .storage\r\n// //     .from('product-images')\r\n// //     .getPublicUrl(filePath);\r\n\r\n// //   const imageUrl = imageData?.publicUrl;\r\n\r\n// //   if (!imageUrl) throw new Error(\"Не удалось получить URL изображения\");\r\n\r\n// //   // Сохранение в PostgreSQL\r\n// //   await db.product.create({\r\n// //     data: {\r\n// //       name,\r\n// //       description,\r\n// //       price,\r\n// //       categoryId,\r\n// //       imageUrl,\r\n// //     },\r\n// //   });\r\n\r\n// //   redirect('/admin/products'); // или куда тебе нужно\r\n// // }\r\n\r\n// export async function updateProduct(formData: FormData) {\r\n//   const data = z\r\n//     .object({\r\n//       id: z.string(),\r\n//       name: z.string(),\r\n//       description: z.string().optional(),\r\n//       price: z.coerce.number().nonnegative(),\r\n//       imageUrl: z.string().url().optional(),\r\n//       categoryId: z.string().optional(),\r\n//     })\r\n//     .parse({\r\n//       id: formData.get(\"id\"),\r\n//       name: formData.get(\"name\"),\r\n//       description: formData.get(\"description\"),\r\n//       price: formData.get(\"price\"),\r\n//       imageUrl: formData.get(\"imageUrl\"),\r\n//       categoryId: formData.get(\"categoryId\"),\r\n//     });\r\n\r\n//   await db.product.update({\r\n//     where: { id: data.id },\r\n//     data: {\r\n//       name: data.name,\r\n//       description: data.description,\r\n//       price: data.price,\r\n//       imageUrl: data.imageUrl,\r\n//       categoryId: data.categoryId,\r\n//     },\r\n//   });\r\n\r\n//   revalidatePath(`/products/${data.id}`); \r\n// }\r\n\r\n// export async function deleteProduct(formData: FormData) {\r\n//     const fd = z\r\n//       .object({\r\n//         id: z.string(),\r\n//       })\r\n//       .parse({\r\n//         id: formData.get(\"id\"),\r\n//       });\r\n//     await db.product.delete({ where: { id: fd.id } });\r\n//     redirect(\"/product\");\r\n//   }\r\n\r\n\r\n// export async function addProductCart(formData: FormData) {\r\n//   const session = await auth();\r\n\r\n//   if (!session?.user?.id) {\r\n//     throw new Error(\"Пользователь не авторизован\");\r\n//   }\r\n\r\n//   const { productId } = z\r\n//     .object({\r\n//       productId: z.string(),\r\n//     })\r\n//     .parse({\r\n//       productId: formData.get(\"productId\"),\r\n//     });\r\n\r\n//   const existingCartItem = await db.cartItem.findFirst({\r\n//     where: {\r\n//       userId: session.user.id,\r\n//       productId,\r\n//     },\r\n//   });\r\n\r\n//   if (existingCartItem) {\r\n//     await db.cartItem.update({\r\n//       where: { id: existingCartItem.id },\r\n//       data: { quantity: { increment: 1 } },\r\n//     });\r\n//   } else {\r\n//     await db.cartItem.create({\r\n//       data: {\r\n//         userId: session.user.id,\r\n//         productId,\r\n//         quantity: 1,\r\n//       },\r\n//     });\r\n//   }\r\n\r\n//    redirect(\"/cart\");\r\n// }\r\n\"use server\";\r\n\r\nimport { randomUUID } from \"crypto\";\r\nimport { revalidatePath } from \"next/cache\";\r\nimport { redirect } from \"next/navigation\";\r\nimport { z } from \"zod\";\r\nimport { auth } from \"~/server/auth\";\r\nimport { db } from \"~/server/db\";\r\n\r\n// export async function createProduct(formData: FormData) {\r\n//   const fd = z\r\n//     .object({\r\n//       name: z.string(),\r\n//       description: z.string(),\r\n//       price: z.coerce.number().positive(),\r\n//       imageUrl: z.string().url().optional().or(z.literal(\"\")),\r\n//       categoryId: z.string(),\r\n//     })\r\n//     .parse({\r\n//       name: formData.get(\"name\"),\r\n//       description: formData.get(\"description\"),\r\n//       price: formData.get(\"price\"),\r\n//       imageUrl: formData.get(\"imageUrl\"),\r\n//       categoryId: formData.get(\"categoryId\"),\r\n//     });\r\n\r\n//   await db.product.create({\r\n//     data: {\r\n//       name: fd.name,\r\n//       description: fd.description,\r\n//       price: fd.price,\r\n//       imageUrl: fd.imageUrl || \"\",\r\n//       categoryId: fd.categoryId,\r\n//     },\r\n//   });\r\n\r\n//   revalidatePath(\"/product\");\r\n//   redirect(\"/product\"); \r\n// }\r\nexport async function createProduct(formData: FormData) {\r\n  const name = formData.get(\"name\") as string;\r\n  const description = formData.get(\"description\") as string;\r\n  const price = Number(formData.get(\"price\"));\r\n  const categoryId = formData.get(\"categoryId\") as string;\r\n  const imageUrl = formData.get(\"imageUrl\") as string;\r\n\r\n  if (!imageUrl) throw new Error(\"Изображение не выбрано\");\r\n\r\n  await db.product.create({\r\n    data: {\r\n      name,\r\n      description,\r\n      price,\r\n      categoryId,\r\n      imageUrl,\r\n    },\r\n  });\r\n\r\n  redirect(\"/product\");\r\n}\r\n\r\n\r\nexport async function updateProduct(formData: FormData) {\r\n  const data = z\r\n    .object({\r\n      id: z.string(),\r\n      name: z.string(),\r\n      description: z.string().optional(),\r\n      price: z.coerce.number().nonnegative(),\r\n      imageUrl: z.string().url().optional(),\r\n      categoryId: z.string().optional(),\r\n    })\r\n    .parse({\r\n      id: formData.get(\"id\"),\r\n      name: formData.get(\"name\"),\r\n      description: formData.get(\"description\"),\r\n      price: formData.get(\"price\"),\r\n      imageUrl: formData.get(\"imageUrl\"),\r\n      categoryId: formData.get(\"categoryId\"),\r\n    });\r\n\r\n  await db.product.update({\r\n    where: { id: data.id },\r\n    data: {\r\n      name: data.name,\r\n      description: data.description,\r\n      price: data.price,\r\n      imageUrl: data.imageUrl,\r\n      categoryId: data.categoryId,\r\n    },\r\n  });\r\n\r\n  revalidatePath(`/products/${data.id}`); \r\n}\r\n\r\nexport async function deleteProduct(formData: FormData) {\r\n    const fd = z\r\n      .object({\r\n        id: z.string(),\r\n      })\r\n      .parse({\r\n        id: formData.get(\"id\"),\r\n      });\r\n    await db.product.delete({ where: { id: fd.id } });\r\n    redirect(\"/product\");\r\n  }\r\n\r\n\r\n// export async function addProductCart(formData: FormData) {\r\n//   const session = await auth();\r\n\r\n//   if (!session?.user?.id) {\r\n//     throw new Error(\"Пользователь не авторизован\");\r\n//   }\r\n\r\n//   const { productId } = z\r\n//     .object({\r\n//       productId: z.string(),\r\n//     })\r\n//     .parse({\r\n//       productId: formData.get(\"productId\"),\r\n//     });\r\n\r\n//   const existingCartItem = await db.cartItem.findFirst({\r\n//     where: {\r\n//       userId: session.user.id,\r\n//       productId,\r\n//     },\r\n//   });\r\n\r\n//   if (existingCartItem) {\r\n//     await db.cartItem.update({\r\n//       where: { id: existingCartItem.id },\r\n//       data: { quantity: { increment: 1 } },\r\n//     });\r\n//   } else {\r\n//     await db.cartItem.create({\r\n//       data: {\r\n//         userId: session.user.id,\r\n//         productId,\r\n//         quantity: 1,\r\n//       },\r\n//     });\r\n//   }\r\n\r\n//    redirect(\"/cart\");\r\n// }\r\nexport async function addProductCart(formData: FormData) {\r\n  const session = await auth();\r\n\r\n  if (!session?.user?.id) {\r\n    throw new Error(\"Пользователь не авторизован\");\r\n  }\r\n\r\n  const { productId, quantity } = z\r\n    .object({\r\n      productId: z.string(),\r\n      quantity: z.string().transform((val) => parseInt(val, 10)),\r\n    })\r\n    .parse({\r\n      productId: formData.get(\"productId\"),\r\n      quantity: formData.get(\"quantity\"),\r\n    });\r\n\r\n  const existingCartItem = await db.cartItem.findFirst({\r\n    where: {\r\n      userId: session.user.id,\r\n      productId,\r\n    },\r\n  });\r\n\r\n  if (existingCartItem) {\r\n    await db.cartItem.update({\r\n      where: { id: existingCartItem.id },\r\n      data: { quantity: { increment: quantity } },\r\n    });\r\n  } else {\r\n    await db.cartItem.create({\r\n      data: {\r\n        userId: session.user.id,\r\n        productId,\r\n        quantity,\r\n      },\r\n    });\r\n  }\r\n\r\n  redirect(\"/cart\");\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 766, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 772, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 777, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}